.piece {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    position: relative;
    transition: transform 0.15s cubic-bezier(0.2, 0.8, 0.2, 1);
    user-select: none;
    z-index: 2;
    /* 盤面より上 */
}

.pieceInner {
    width: 82%;
    height: 92%;
    /* 本黄楊（ほんつげ）のような明るく深みのある黄色・飴色 */
    background-color: #f5cca0;

    /* よりリアルな将棋の駒の形 */
    clip-path: polygon(50% 0%, 85% 25%, 80% 100%, 20% 100%, 15% 25%);
    display: flex;
    justify-content: center;
    align-items: center;

    /* 木目、丸み、光沢感の表現 */
    background-image:
        /* 左上からのハイライトと右下へのシャドウ（立体感） */
        linear-gradient(135deg, rgba(255, 255, 255, 0.6) 0%, rgba(255, 255, 255, 0) 30%, rgba(0, 0, 0, 0) 60%, rgba(0, 0, 0, 0.2) 100%),
        /* 微細な木目 */
        repeating-linear-gradient(85deg, rgba(139, 69, 19, 0.08) 0px, rgba(139, 69, 19, 0.08) 1px, transparent 1px, transparent 4px),
        /* やや大まかな木目 */
        repeating-linear-gradient(95deg, rgba(139, 69, 19, 0.05) 0px, rgba(139, 69, 19, 0.05) 1px, transparent 1px, transparent 10px),
        /* 全体のベースカラーのグラデーション */
        linear-gradient(to bottom, #fcebc4, #ecae5e);

    /* 盤から浮き出ているようなドロップシャドウ */
    filter: drop-shadow(1px 4px 3px rgba(0, 0, 0, 0.5));

    /* 駒の厚みと面取りを感じさせるインナーシャドウ */
    box-shadow:
        inset 0 2px 4px rgba(255, 255, 255, 0.8),
        inset 0 -4px 6px rgba(100, 40, 0, 0.4),
        inset -1px 0 2px rgba(100, 40, 0, 0.2),
        inset 1px 0 2px rgba(255, 255, 255, 0.4);
}

.gote {
    transform: rotate(180deg);
}

.kanji {
    font-family: "Klee One", "游明朝", "Yu Mincho", "Hiragino Mincho ProN", serif;
    font-weight: 800;
    /* 太くして力強さを出す */
    font-size: clamp(14px, 3.0vw, 25px);

    /* 漆のような黒と、盛り上げ駒特有の立体感 */
    color: #1a1a1a;
    text-shadow:
        1px 1px 0px rgba(255, 255, 255, 0.5),
        /* 光の反射 */
        -0.5px -0.5px 0px rgba(0, 0, 0, 0.3),
        /* 微小な影 */
        0px 0px 1px rgba(0, 0, 0, 0.5);
    /* 縁取りを少しにじませて漆風に */

    line-height: 1;
    padding-top: 12%;
    /* 重心が少し下にあるように見せる */
}

/* 成駒の色（深みのある朱色） */
.promoted .kanji {
    color: #cc2211;
    text-shadow:
        1px 1px 0px rgba(255, 255, 255, 0.5),
        -0.5px -0.5px 0px rgba(100, 0, 0, 0.4),
        0px 0px 1px rgba(150, 0, 0, 0.5);
}

/* 駒を選択した時のエフェクト */
.selected {
    transform: scale(1.1) translateY(-3px);
    z-index: 10;
}

.selected .pieceInner {
    /* 選択時は少し明るくし、オーラを纏う */
    background-image:
        linear-gradient(135deg, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0.2) 40%, rgba(0, 0, 0, 0) 70%, rgba(0, 0, 0, 0.1) 100%),
        repeating-linear-gradient(85deg, rgba(139, 69, 19, 0.08) 0px, rgba(139, 69, 19, 0.08) 1px, transparent 1px, transparent 4px),
        linear-gradient(to bottom, #fff4d4, #f8c87e);
    filter: drop-shadow(0 8px 6px rgba(0, 0, 0, 0.4)) drop-shadow(0 0 8px rgba(255, 215, 0, 0.6));
}

.lastMove::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 130%;
    height: 130%;
    background: radial-gradient(circle, rgba(144, 238, 144, 0.4) 0%, transparent 70%);
    border-radius: 50%;
    z-index: -1;
    animation: flashMove 2s infinite;
}

@keyframes flashMove {
    0% {
        opacity: 0.5;
    }

    50% {
        opacity: 1;
    }

    100% {
        opacity: 0.5;
    }
}

/* 持ち駒台などでの見た目調整（必要に応じて） */
.piece[data-komadai="true"] {
    transform: scale(0.9);
}