.container {
    width: 100vw;
    height: 100vh;
    background: #f8f9fa;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #333;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    user-select: none;
    overflow: hidden;
    position: relative;
}

/* Loading Overlay */
.loadingOverlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255, 255, 255, 0.9);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #333;
}

.loadingBarContainer {
    width: 300px;
    height: 4px;
    background: #eee;
    border-radius: 2px;
}

.loadingBarFill {
    height: 100%;
    background: #333;
    transition: width 0.1s;
}

/* Header */
.header {
    margin-bottom: 2.5rem;
    text-align: center;
    flex-shrink: 0;
}

.title {
    margin: 0;
    font-weight: 300;
    letter-spacing: 2px;
    color: #111;
    font-size: 2rem;
}

.subtitle {
    color: #888;
    font-size: 0.8rem;
    margin-top: 0.5rem;
    letter-spacing: 1px;
}

/* Control Panel */
.controlPanel {
    display: flex;
    gap: 2.5rem;
    margin-bottom: 2rem;
    background: #fff;
    padding: 1.2rem 2.5rem;
    border-radius: 50px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
    align-items: center;
    flex-shrink: 0;
    z-index: 100;
}

.controlGroup {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.controlGroup+.controlGroup {
    border-left: 1px solid #eee;
    padding-left: 2.5rem;
}

.label {
    font-size: 0.7rem;
    color: #999;
    margin-bottom: 0.5rem;
    font-weight: 600;
    white-space: nowrap;
}

.slider {
    width: 80px;
    cursor: pointer;
    accent-color: #333;
}

.select {
    background: transparent;
    color: #333;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 6px 12px;
    font-size: 0.85rem;
    outline: none;
    cursor: pointer;
    min-width: 160px;
}

.metronomeButton {
    border: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
}

/* Piano Chassis */
.pianoChassis {
    position: relative;
    background: #fff;
    padding: 30px 20px 20px 20px;
    border-radius: 12px;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.1);
    border: 1px solid #f0f0f0;
    max-width: 100vw;
}

.keysContainer {
    display: flex;
    position: relative;
    z-index: 1;
}

/* Keys */
.whiteKey {
    width: 60px;
    height: 280px;
    border: 1px solid #e0e0e0;
    border-radius: 0 0 4px 4px;
    margin-right: -1px;
    cursor: pointer;
    position: relative;
    z-index: 1;
    transform-origin: top;
    transition: transform 0.05s ease-out, background 0.1s;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding-bottom: 20px;
    font-weight: 500;
    font-size: 0.7rem;
    flex-shrink: 0;
    /* Prevent compression */
}

.blackKey {
    position: absolute;
    top: 0;
    width: 40px;
    height: 170px;
    border-radius: 0 0 3px 3px;
    cursor: pointer;
    z-index: 10;
    transform-origin: top;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding-bottom: 15px;
    font-size: 0.6rem;
    transition: transform 0.05s ease-out;
}

/* Footer & MIDI */
.footer {
    padding-top: 1rem;
    display: flex;
    gap: 20px;
    flex-shrink: 0;
}

.midiStatus {
    position: fixed;
    bottom: 20px;
    right: 20px;
    font-size: 0.8rem;
    display: flex;
    align-items: center;
    gap: 6px;
    background: rgba(255, 255, 255, 0.8);
    padding: 4px 8px;
    border-radius: 4px;
    backdrop-filter: blur(4px);
}

/* Portrait Overlay */
.portraitOverlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: #1a202c;
    color: white;
    z-index: 9999;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 2rem;
}

.rotateIcon {
    width: 64px;
    height: 64px;
    margin-bottom: 1.5rem;
    animation: rotateAnimation 2s infinite;
}

@keyframes rotateAnimation {
    0% {
        transform: rotate(0deg);
    }

    30% {
        transform: rotate(-90deg);
    }

    100% {
        transform: rotate(-90deg);
    }
}

/* Mobile Portrait Enforcement */
@media (max-width: 900px) and (orientation: portrait) {
    .portraitOverlay {
        display: flex;
    }

    /* Hide main content when asking to rotate */
    .header,
    .controlPanel,
    .pianoChassis,
    .footer,
    .midiStatus {
        display: none !important;
    }
}

/* Mobile Landscape Optimization */
@media (max-height: 500px) and (orientation: landscape) {
    .container {
        padding: 0;
        /* Remove padding to fully utilize screen */
        justify-content: flex-start;
        overflow: hidden;
    }

    .header {
        display: none;
    }

    .footer {
        display: none;
    }

    /* Ultra Compact Control Panel */
    .controlPanel {
        padding: 0.2rem 1rem;
        margin: 0;
        /* No margin */
        gap: 0.5rem;
        transform: scale(0.8);
        transform-origin: top center;
        width: 100%;
        /* Full width */
        border-radius: 0 0 20px 20px;
        /* Rounded bottom only */
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(5px);
        z-index: 20;
        justify-content: center;
    }

    .controlGroup {
        min-width: auto;
    }

    .controlGroup+.controlGroup {
        padding-left: 0.8rem;
    }

    .label {
        display: none;
        /* Hide labels to save vertical space! */
    }

    .slider {
        width: 50px;
        height: 4px;
        /* Thinner slider */
    }

    .select {
        padding: 0 4px;
        height: 20px;
        font-size: 0.7rem;
        min-width: 100px;
    }

    .metronomeButton {
        width: 20px;
        height: 20px;
    }

    /* Piano Chassis fills remaining space */
    .pianoChassis {
        padding: 0;
        margin: 0;
        border-radius: 0;
        flex: 1;
        /* Grow to fill space */
        display: flex;
        align-items: stretch;
        /* Stretch children to full height */
        overflow-y: hidden;
        overflow-x: auto;
        box-shadow: none;
        width: 100%;
        border: none;
        background: transparent;
    }

    .pianoChassis::-webkit-scrollbar {
        height: 0;
        /* Hide scrollbar for immersion, user can still swipe? Or make very thin */
        width: 0;
    }

    .keysContainer {
        height: 100%;
        /* Fill chassis */
        display: flex;
        align-items: stretch;
        /* Stretch keys to full height */
        /* padding-bottom: 0; */
    }

    .whiteKey {
        width: auto;
        /* Allow dynamic width? No, keep fixed for scroll */
        min-width: 50px;
        /* Reduced width to fit more? User wants BIGGER keys usually meaning longer */
        width: 60px;
        height: 100% !important;
        /* Force fill container height */
        min-height: auto;
        /* Remove constraints */
        border-radius: 0 0 8px 8px;
        border-bottom-width: 4px !important;
        /* Thinner bottom border */
    }

    .blackKey {
        width: 36px;
        height: 60% !important;
    }

    .midiStatus {
        display: none;
    }
}

/* Mobile Responsive (General) */
@media (max-width: 768px) {
    .container {
        /* Reset height logic for general mobile if not caught by specific queries */
        height: 100vh;
        height: 100dvh;
        /* Dynamic usage */
        justify-content: flex-start;
        padding-top: 20px;
        overflow-y: auto;
        /* Allow layout scrolling if needed */
    }

    .header {
        margin-bottom: 1rem;
    }

    .title {
        font-size: 1.5rem;
    }

    .controlPanel {
        flex-wrap: wrap;
        width: 90%;
        padding: 1rem;
        border-radius: 20px;
        gap: 1rem;
        justify-content: center;
        margin-bottom: 1rem;
    }

    .controlGroup {
        flex: 1 1 40%;
        min-width: 120px;
    }

    .controlGroup+.controlGroup {
        border-left: none;
        padding-left: 0;
        border-top: 1px solid #eee;
        /* Optional visual separator for stacked items? Or just gap */
        padding-top: 0;
        /* Let flex gap handle it */
    }

    /* Specific adjustment to remove borders completely on mobile for cleaner look */
    .controlGroup+.controlGroup {
        border: none;
        padding: 0;
    }

    .pianoChassis {
        width: 95%;
        padding: 10px;
        overflow-x: auto;
        /* Horizontal scroll for keys */
        -webkit-overflow-scrolling: touch;
        justify-content: flex-start;
        /* Ensure start alignment */
    }

    .pianoChassis::-webkit-scrollbar {
        height: 6px;
    }

    .pianoChassis::-webkit-scrollbar-thumb {
        background: #ccc;
        border-radius: 3px;
    }

    .keysContainer {
        /* Ensure user can scroll to see all keys */
        min-width: max-content;
        padding-bottom: 10px;
        /* Space for scrollbar */
    }

    .whiteKey {
        width: 44px;
        /* Slightly narrower on mobile? or keep same */
        height: 220px;
        /* Shorter */
    }

    .blackKey {
        width: 28px;
        height: 130px;
        /* Need to recalculate left positions in JS or use percentages, but JS fixed px is used currently. 
           We might need to adjust the calculation logic in TSX if we change width here.
           Let's KEEP WIDTHS SAME for simplicity of 'left' calculation, just enable SCROLL.
        */
        width: 40px;
        height: 170px;
    }

    /* If we keep widths same, we just rely on scroll */
    .whiteKey {
        width: 60px;
        height: 280px;
    }

    .blackKey {
        width: 40px;
        height: 170px;
    }
}