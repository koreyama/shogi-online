.container {
    width: 100vw;
    height: 100vh;
    background: #f8f9fa;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #333;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    user-select: none;
    overflow: hidden;
    position: relative;
}

/* Loading Overlay */
.loadingOverlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255, 255, 255, 0.9);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #333;
}

.loadingBarContainer {
    width: 300px;
    height: 4px;
    background: #eee;
    border-radius: 2px;
}

.loadingBarFill {
    height: 100%;
    background: #333;
    transition: width 0.1s;
}

/* Header */
.header {
    margin-bottom: 2.5rem;
    text-align: center;
    flex-shrink: 0;
}

.title {
    margin: 0;
    font-weight: 300;
    letter-spacing: 2px;
    color: #111;
    font-size: 2rem;
}

.subtitle {
    color: #888;
    font-size: 0.8rem;
    margin-top: 0.5rem;
    letter-spacing: 1px;
}

/* Control Panel */
.controlPanel {
    display: flex;
    gap: 2.5rem;
    margin-bottom: 2rem;
    background: #fff;
    padding: 1.2rem 2.5rem;
    border-radius: 50px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
    align-items: center;
    flex-shrink: 0;
    z-index: 100;
}

.controlGroup {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.controlGroup+.controlGroup {
    border-left: 1px solid #eee;
    padding-left: 2.5rem;
}

.label {
    font-size: 0.7rem;
    color: #999;
    margin-bottom: 0.5rem;
    font-weight: 600;
    white-space: nowrap;
}

.slider {
    width: 80px;
    cursor: pointer;
    accent-color: #333;
}

.select {
    background: transparent;
    color: #333;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 6px 12px;
    font-size: 0.85rem;
    outline: none;
    cursor: pointer;
    min-width: 160px;
}

.metronomeButton {
    border: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
}

/* Piano Chassis */
.pianoChassis {
    position: relative;
    background: #fff;
    padding: 30px 20px 20px 20px;
    border-radius: 12px;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.1);
    border: 1px solid #f0f0f0;
    max-width: 100vw;
}

.keysContainer {
    display: flex;
    position: relative;
    z-index: 1;
}

/* Keys */
.whiteKey {
    width: 60px;
    height: 280px;
    border: 1px solid #e0e0e0;
    border-radius: 0 0 4px 4px;
    margin-right: -1px;
    cursor: pointer;
    position: relative;
    z-index: 1;
    transform-origin: top;
    transition: transform 0.05s ease-out, background 0.1s;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding-bottom: 20px;
    font-weight: 500;
    font-size: 0.7rem;
    flex-shrink: 0;
    /* Prevent compression */
}

.blackKey {
    position: absolute;
    top: 0;
    width: 40px;
    height: 170px;
    border-radius: 0 0 3px 3px;
    cursor: pointer;
    z-index: 10;
    transform-origin: top;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding-bottom: 15px;
    font-size: 0.6rem;
    transition: transform 0.05s ease-out;
}

/* Footer & MIDI */
.footer {
    padding-top: 1rem;
    display: flex;
    gap: 20px;
    flex-shrink: 0;
}

.midiStatus {
    position: fixed;
    bottom: 20px;
    right: 20px;
    font-size: 0.8rem;
    display: flex;
    align-items: center;
    gap: 6px;
    background: rgba(255, 255, 255, 0.8);
    padding: 4px 8px;
    border-radius: 4px;
    backdrop-filter: blur(4px);
}

/* Portrait Overlay */
.portraitOverlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: #1a202c;
    color: white;
    z-index: 9999;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 2rem;
}

.rotateIcon {
    width: 64px;
    height: 64px;
    margin-bottom: 1.5rem;
    animation: rotateAnimation 2s infinite;
}

@keyframes rotateAnimation {
    0% {
        transform: rotate(0deg);
    }

    30% {
        transform: rotate(-90deg);
    }

    100% {
        transform: rotate(-90deg);
    }
}

/* Mobile Portrait Enforcement */
@media (max-width: 900px) and (orientation: portrait) {
    .portraitOverlay {
        display: flex;
    }

    /* Hide main content when asking to rotate */
    .header,
    .controlPanel,
    .pianoChassis,
    .footer,
    .midiStatus {
        display: none !important;
    }
}

/* Mobile Landscape Optimization */
@media (max-height: 500px) and (orientation: landscape) {
    .container {
        padding: 5px;
        justify-content: flex-start;
        /* Top align to maximize space */
        overflow: hidden;
        /* Prevent body scroll */
    }

    .header {
        display: none;
    }

    .footer {
        display: none;
    }

    .controlPanel {
        padding: 0.3rem 1rem;
        margin-bottom: 0.4rem;
        gap: 0.8rem;
        transform: scale(0.85);
        /* Smaller scale */
        transform-origin: top center;
        width: auto;
        border-radius: 20px;
        flex-wrap: nowrap;
        /* Force single row if possible */
    }

    .controlGroup {
        min-width: auto;
        /* Allow shrinking */
    }

    .label {
        font-size: 0.6rem;
        margin-bottom: 0.1rem;
    }

    .slider {
        width: 60px;
        /* Shorter sliders */
    }

    .select {
        padding: 2px 6px;
        font-size: 0.75rem;
        min-width: 120px;
    }

    .controlGroup+.controlGroup {
        padding-left: 1rem;
    }

    .pianoChassis {
        padding: 0 5px;
        border-radius: 6px;
        flex: 1;
        /* Take all remaining vertical space */
        display: flex;
        align-items: flex-end;
        overflow-y: hidden;
        overflow-x: auto;
        /* max-height removed to allow full fill */
        box-shadow: none;
        /* Flatter look */
        width: 100%;
        border: none;
        background: transparent;
        /* Seamless */
    }

    .keysContainer {
        height: 100%;
        /* Fill chassis */
        display: flex;
        align-items: flex-start;
        /* Actually we want keys to be top-aligned or stretch? */
        /* Keys are styled to fill height */
    }

    .whiteKey {
        width: 60px;
        height: 100% !important;
        /* Force fill container height */
        min-height: 140px;
        border-radius: 0 0 6px 6px;
    }

    .blackKey {
        width: 40px;
        height: 65% !important;
        /* Proportional */
    }

    .midiStatus {
        display: none;
        /* Hide MIDI status to clear screen */
    }
}

/* Mobile Responsive (General) */
@media (max-width: 768px) {
    .container {
        /* Reset height logic for general mobile if not caught by specific queries */
        height: 100vh;
        height: 100dvh;
        /* Dynamic usage */
        justify-content: flex-start;
        padding-top: 20px;
        overflow-y: auto;
        /* Allow layout scrolling if needed */
    }

    .header {
        margin-bottom: 1rem;
    }

    .title {
        font-size: 1.5rem;
    }

    .controlPanel {
        flex-wrap: wrap;
        width: 90%;
        padding: 1rem;
        border-radius: 20px;
        gap: 1rem;
        justify-content: center;
        margin-bottom: 1rem;
    }

    .controlGroup {
        flex: 1 1 40%;
        min-width: 120px;
    }

    .controlGroup+.controlGroup {
        border-left: none;
        padding-left: 0;
        border-top: 1px solid #eee;
        /* Optional visual separator for stacked items? Or just gap */
        padding-top: 0;
        /* Let flex gap handle it */
    }

    /* Specific adjustment to remove borders completely on mobile for cleaner look */
    .controlGroup+.controlGroup {
        border: none;
        padding: 0;
    }

    .pianoChassis {
        width: 95%;
        padding: 10px;
        overflow-x: auto;
        /* Horizontal scroll for keys */
        -webkit-overflow-scrolling: touch;
        justify-content: flex-start;
        /* Ensure start alignment */
    }

    .pianoChassis::-webkit-scrollbar {
        height: 6px;
    }

    .pianoChassis::-webkit-scrollbar-thumb {
        background: #ccc;
        border-radius: 3px;
    }

    .keysContainer {
        /* Ensure user can scroll to see all keys */
        min-width: max-content;
        padding-bottom: 10px;
        /* Space for scrollbar */
    }

    .whiteKey {
        width: 44px;
        /* Slightly narrower on mobile? or keep same */
        height: 220px;
        /* Shorter */
    }

    .blackKey {
        width: 28px;
        height: 130px;
        /* Need to recalculate left positions in JS or use percentages, but JS fixed px is used currently. 
           We might need to adjust the calculation logic in TSX if we change width here.
           Let's KEEP WIDTHS SAME for simplicity of 'left' calculation, just enable SCROLL.
        */
        width: 40px;
        height: 170px;
    }

    /* If we keep widths same, we just rely on scroll */
    .whiteKey {
        width: 60px;
        height: 280px;
    }

    .blackKey {
        width: 40px;
        height: 170px;
    }
}